IDENTIFICATION DIVISION.
PROGRAM-ID. P2.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT IN-FILE  ASSIGN TO "P2In.dat" ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD IN-FILE.
01 IN-RECORD.
    02 NAME             PIC A(19).
    02 W-NUMBER         PIC X(10).
    02 SEMESTER         PIC X(13).
    02 COURSE           PIC X(13).
    02 DESCRIPTION      PIC X(30).
    02 GRADE            PIC A.

WORKING-STORAGE SECTION.
01 EOF PIC A VALUE "N".

PROCEDURE DIVISION.
MAIN-LOGIC SECTION.
PROGRAM-BEGIN.

    PERFORM OPENING-PROCEDURE.
    PERFORM READ-NEXT-RECORD.
    PERFORM DISPLAY-RECORD
        UNTIL EOF = "Y".
    PERFORM CLOSING-PROCEDURE.

PROGRAM-DONE.
    STOP RUN.

OPENING-PROCEDURE.
    OPEN INPUT IN-FILE.

CLOSING-PROCEDURE.
    CLOSE IN-FILE.

READ-NEXT-RECORD.
    READ IN-FILE NEXT RECORD
        AT END
            MOVE "Y" TO EOF.

DISPLAY-RECORD.
    DISPLAY NAME, W-NUMBER, SEMESTER, COURSE, DESCRIPTION, GRADE.
    PERFORM READ-NEXT-RECORD.
