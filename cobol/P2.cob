IDENTIFICATION DIVISION.
PROGRAM-ID. P2.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT IN-FILE ASSIGN TO "P2In.dat"
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
FD IN-FILE.
01 IN-RECORD.
    05 NAME             PIC A(19).
    05 W-NUMBER         PIC X(10).
    05 SEMESTER         PIC X(13).
    05 COURSE           PIC X(13).
    05 DESCRIPTION      PIC X(30).
    05 GRADE            PIC A(5).

WORKING-STORAGE SECTION.
01 SCHOOL-NAME          PIC A(80) VALUE "SOUTHEASTERN LOUISIANA UNIVSERITY".
01 SCHOOL-ADDR          PIC X(80) VALUE "HAMMOND, LA 70402".
01 LABELS.
    05 FILLER           PIC X(13) VALUE "COURSE".
    05 FILLER           PIC X(30) VALUE "DESCRIPTION".
    05 FILLER           PIC A(5)  VALUE "GRADE".
01 EOF                  PIC A     VALUE "N".

PROCEDURE DIVISION.
MAIN-LOGIC SECTION.
PROGRAM-BEGIN.

    PERFORM OPENING-PROCEDURE.
    PERFORM READ-NEXT-RECORD.
    PERFORM DISPLAY-REPORT.
    PERFORM DISPLAY-RECORD
        UNTIL EOF = "Y".
    PERFORM CLOSING-PROCEDURE.

PROGRAM-DONE.
    STOP RUN.

OPENING-PROCEDURE.
    OPEN INPUT IN-FILE.

CLOSING-PROCEDURE.
    CLOSE IN-FILE.

DISPLAY-REPORT.
    DISPLAY SCHOOL-NAME.
    DISPLAY SCHOOL-ADDR.
    DISPLAY SPACE.
    DISPLAY NAME.
    DISPLAY W-NUMBER.
    DISPLAY SPACE.
    DISPLAY SEMESTER.
    DISPLAY LABELS.

READ-NEXT-RECORD.
    READ IN-FILE NEXT RECORD
        AT END
            MOVE "Y" TO EOF.

DISPLAY-RECORD.
    DISPLAY COURSE, DESCRIPTION, GRADE.
    PERFORM READ-NEXT-RECORD.
